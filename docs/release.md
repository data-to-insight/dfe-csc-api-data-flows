# CSC API Pipeline, Release Overview

This page explains what is in each release, how to download it, and the minimum steps to check your environment.

You can visit the GitHub Releases page directly:
https://github.com/data-to-insight/dfe-csc-api-data-flows/releases

---

## What should I download

- Most users, download `release.zip` and `pre_flight_checks.zip`. Run the SQL checks in SSMS and the credentials smoke test in PowerShell first. You will use `csc_api_pipeline.exe` after those pass.
- Teams that manage Python at the LA, install the wheel from `release.zip` with `pip install <path-to>\csc_api_pipeline-<version>-py3-none-any.whl`, then use the CLI entry points `d2i-csc-api` or `csc-api-pipeline` (see README).
- Auditors or platform engineers, use `csc_api_pipeline-*.tar.gz` to rebuild locally if required.


---

## Choose your path

### For most users (service teams, analysts, non developers)

Download two files from the latest release:
- `release.zip`
- `pre_flight_checks.zip`

Then follow these steps.

1) Extract both zip files to a work folder that you have write access to.

2) Run the pre flight checks first, inside the correct tools.
   - In SQL Server Management Studio, open:
     - `pre_flight_checks/ssd_vw_csc_api_schema_checks.sql` (read only, confirms SSD schema and views)
     - If your DB does not already have the staging objects, run **one** of:
       - `sql_json_query/populate_ssd_api_data_staging_2016sp1.sql` (SQL Server 2016 SP1 and above)
       - `sql_json_query/populate_ssd_api_data_staging_2012.sql` (SQL Server 2012)
   - In Windows PowerShell, open:
     - `pre_flight_checks/phase_1_api_credentials_smoke_test.ps1`
     - Add your DfE credentials in the **---- LA Config ----** block, then run to confirm endpoint access.


3) Run the pipeline.
   - Easiest, use the Windows executable: download `csc_api_pipeline.exe` from the same release, then run it. Use `--help` to see commands.
   - If your IT team prefers a Python install, ask them to install the wheel from `release.zip` instead.

  **Quick start**

  - Windows exe:
    ```powershell
    csc_api_pipeline.exe --help 
    ```
    Python CLI, after installing the wheel:
    ```
      d2i-csc-api --help
    # or
    csc-api-pipeline --help
    ```

  If anything is blocked by policy, please contact your IT team.

---

### For technical teams (infrastructure, devops, developers)

This table shows the assets we publish and where they also appear.

| Asset | Purpose | Also inside `release.zip` |
|---|---|---|
| `pre_flight_checks.zip` | Self contained pre flight set, schema check and credentials smoke test | No |
| `release.zip` | Bundle for distribution, README, notebooks, `.env.example`, phase 1 PowerShell script, wheel, sdist, SQL files | â€” |
| `csc_api_pipeline.exe` | Windows executable, single file CLI | No |
| `csc_api_pipeline-*.whl` | Wheel for `pip install` | Yes |
| `csc_api_pipeline-*.tar.gz` | Source distribution | Yes |
| `SHA256SUMS.txt` | Checksums for files in `dist` | No |
| Source code (zip, tar.gz) | Auto generated by GitHub, repository snapshot | No |

Note, the executable is published as a stand alone asset, it is not inside `release.zip`. The wheel and sdist are published both as stand alone files and inside `release.zip` for convenience.


---

## Verification, for technical teams

Use SHA-256 checksums to verify downloads. Adjust paths to the folder where you saved the files.

### Windows PowerShell
```powershell
Get-FileHash .\csc_api_pipeline-*.whl -Algorithm SHA256
Get-FileHash .\csc_api_pipeline-*.tar.gz -Algorithm SHA256
Get-FileHash .\csc_api_pipeline.exe -Algorithm SHA256
Get-FileHash .\SHA256SUMS.txt -Algorithm SHA256

```

### Linux/macOS
```bash
sha256sum csc_api_pipeline-*.whl
sha256sum csc_api_pipeline-*.tar.gz
sha256sum csc_api_pipeline.exe
```

Compare the values with SHA256SUMS.txt attached to the release.
If you extracted release.zip, verify any individual files you plan to run, for example:

Other files:

```bash
sha256sum phase_1_api_payload.ps1
sha256sum sql_json_query/populate_ssd_api_data_staging_2016sp1.sql

```

Compare hash results with [GitHub Releases page](https://github.com/data-to-insight/dfe-csc-api-data-flows/releases).

---


## Changelog

Main changelogv is `CHANGELOG.md` at repo root. This page only highlights major changes.
Note: Versioning follows semantic versioning (`v0.1.0`, `v1.2.3`, etc.)

### v0.2.9 
**Released:** 16/10/2025  **Tag:** `v0.2.9`  

**Changes**
- Major clean-up to reduce duplication in released assets listing 
- Both pre-flight checks included in new zip (Credentials/connectivity(.ps1) and SSD (SystemC only) schema check (.sql))
- Bug/enhancement ticket flixes for #34, #35, #40, #41, #47, #38, 
- New Fabric compatible/Jupyter flattened deployment notebook/script (from existing CLI) (enhancement)


### v0.1.2 
**Released:** 13/08/2025  **Tag:** `v0.1.2`  

**Changes**
- Updated `release.sh` to:
  - Auto-increment and tag versions based on latest release
  - Bump version in `pyproject.toml` and commit the change
  - Include `.ps1` and `.sql` helper scripts in the release bundle
- Ensured `.whl`, `.tar.gz`, and `.zip` archives aconsistently built and included
- Added safety check to only run release script from the `main` branch
- Added summary output showing bundled contents after release
- Improved inline documentation for the release script and workflows

#### Notes
- Release focused on cleanup/consistency/usability improvements in packaging and deployment process  
- Release re-aligns local `release.sh` script and GitHub Actions workflow 
- Supporting documentation and helper scripts bundled


### v0.1.1
**Released:** 30 June 2025  **Tag:** `v0.1.1`

**Changes:**
- Initial CLI refactor with `entry_point.py`
- Added support for running as `.exe` via PyInstaller
- New `release.sh` script for automating version bumps and packaging
- Improved documentation and CLI help text output
- GitHub Actions now builds and uploads `.exe`, docs, and `.env.example`

---

